package com.saveMoney.application;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.BeanPropertyRowMapper;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Repository;

@Repository
public class Shops {

	@Autowired
	private JdbcTemplate jt = new JdbcTemplate();

	private String username;
	private String password;
	private String shop_type;
	private String shop_name;
	private String shop_address;
	private String shop_postcode;
	private String shop_longitutde;
	private String shop_latitude;
	private int shop_crowd_flag;
	private int shop_crowd;
	private String shop_status;

	
	public Shops() {
		this.shop_crowd = 0;
		this.shop_status = "open";
	}
	

	
	


	public Shops(String username, String password, String shop_type, String shop_name,
			String shop_address, String shop_postcode, String shop_longitutde, String shop_latitude,
			int shop_crowd_flag) {
	
		this.username = username;
		this.password = password;
		this.shop_type = shop_type;
		this.shop_name = shop_name;
		this.shop_address = shop_address;
		this.shop_postcode = shop_postcode;
		this.shop_longitutde = shop_longitutde;
		this.shop_latitude = shop_latitude;
		this.shop_crowd_flag = shop_crowd_flag;
	}






	//
	
	public void writeSuperMarket() {

		
		String query = "INSERT INTO  shops (username,password,shop_name,shop_address,shop_longitutde,shop_latitude,shop_crowd,shop_status ) VALUES (?,?,?,?,?,?,?,?)";
		jt.update(query, username, password, shop_name, shop_address, shop_longitutde, shop_latitude, shop_crowd,shop_status);
		
//		String query ="CREATE TABLE roles(\n"
//				+ "   role_id serial PRIMARY KEY,\n"
//				+ "   role_name VARCHAR (255) UNIQUE NOT NULL\n"
//				+ ");";
//	this.jt.update(query);
	}


	public void updatePersonCount() {
		String query ="UPDATE shops SET shop_crowd = " + String.valueOf(this.shop_crowd) + " WHERE username = '" + this.username + "'";
		jt.update(query);
	}


	public void updateShopStatus() {
		String query ="UPDATE shops SET shop_status = '" + this.shop_status + "' WHERE username = '" + this.username + "'";
		jt.update(query);
	}


	public String getAddressSuperMarket(String username2) {
		String query = "SELECT shop_address FROM shops WHERE username = '" + this.username + "'";
		List <Shops> address = jt.query(query,new BeanPropertyRowMapper<Shops>(Shops.class));
		return address.get(0).getShop_address();
	}

}
